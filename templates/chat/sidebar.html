<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<!-- Sidebar -->
<div class="w-1/4 bg-white border-r border-gray-300 flex flex-col">
    <!-- Header -->
    <div class="p-4 border-b border-gray-300 flex justify-between items-center bg-blue-600 text-white">
        <h1 class="text-xl font-semibold">Messenger</h1>
        <div class="flex items-center space-x-4">
            <a href="{% url 'create_group' %}" class="hover:text-blue-200" title="Create Group">
                <i class="fas fa-users"></i>
            </a>
            <a href="{% url 'invite_user' %}" class="hover:text-blue-200" title="Invite Friends">
                <i class="fas fa-user-plus"></i>
            </a>
            <a href="{% url 'profile' %}" class="hover:text-blue-200" title="Profile">
                <i class="fas fa-user"></i>
            </a>
            <a href="{% url 'logout' %}" class="hover:text-blue-200" title="Logout">
                <i class="fas fa-sign-out-alt"></i>
            </a>
        </div>
    </div>

    <!-- Search -->
    <div class="p-4 border-b border-gray-300">
        <input type="text" placeholder="Search conversations..."
               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500">
    </div>

    <!-- Quick Actions Menu -->
    <div class="p-4 border-b border-gray-300 bg-gray-50">
        <div class="space-y-2">
            <!-- Invite Friends Button -->
            <a href="{% url 'invite_user' %}" class="flex items-center p-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition duration-200">
                <i class="fas fa-user-plus mr-3"></i>
                <span class="font-medium">Invite Friends</span>
            </a>

            <!-- My Invitations Button -->
            <a href="{% url 'invitations_list' %}" class="flex items-center p-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition duration-200">
                <i class="fas fa-envelope mr-3"></i>
                <span class="font-medium">My Invitations</span>
            </a>

            <!-- Create Group Button -->
            <a href="{% url 'create_group' %}" class="flex items-center p-3 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition duration-200">
                <i class="fas fa-users mr-3"></i>
                <span class="font-medium">Create Group</span>
            </a>
        </div>
    </div>

    <!-- Conversations List -->
    <div class="flex-1 overflow-y-auto">
        {% for conversation in conversations %}
        <a href="{% url 'conversation_detail' conversation.id %}"
           class="flex items-center p-4 border-b border-gray-200 hover:bg-gray-50 transition duration-200">
            <div class="relative">
                {% if conversation.is_group %}
                <div class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center text-white">
                    <i class="fas fa-users"></i>
                </div>
                {% else %}
                <!-- Get the other user in the conversation -->
                {% for user in conversation.participants.all %}
                    {% if user != request.user %}
                    <div class="w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center text-white">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white"></div>
                    {% endif %}
                {% endfor %}
                {% endif %}
            </div>
            <div class="ml-4 flex-1">
                <div class="flex justify-between items-center">
                    <h3 class="font-semibold">
                        {% if conversation.is_group %}
                            {{ conversation.group_name }}
                        {% else %}
                            <!-- Display other user's username -->
                            {% for user in conversation.participants.all %}
                                {% if user != request.user %}
                                    {{ user.username }}
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    </h3>
                    <span class="text-xs text-gray-500">{{ conversation.updated_at|timesince }} ago</span>
                </div>
                <p class="text-sm text-gray-600 truncate">
                    {% with last_message=conversation.messages.last %}
                        {% if last_message %}
                            {{ last_message.content|truncatewords:5 }}
                        {% else %}
                            No messages yet
                        {% endif %}
                    {% endwith %}
                </p>
            </div>
        </a>
        {% empty %}
        <div class="p-4 text-center text-gray-500">
            No conversations yet.
            <a href="{% url 'invite_user' %}" class="text-blue-600 hover:text-blue-500 font-medium">
                Invite friends to start chatting!
            </a>
        </div>
        {% endfor %}
    </div>

    <!-- Online Users Section -->
    <div class="p-4 border-t border-gray-300 bg-gray-50">
        <h3 class="font-semibold mb-3 text-gray-700">Quick Actions</h3>
        <div class="space-y-2">
            <a href="{% url 'invite_user' %}" class="flex items-center p-2 text-gray-700 hover:bg-white rounded-lg transition duration-200">
                <i class="fas fa-user-plus mr-3 text-green-500"></i>
                <span>Invite Friends</span>
            </a>
            <a href="{% url 'invitations_list' %}" class="flex items-center p-2 text-gray-700 hover:bg-white rounded-lg transition duration-200">
                <i class="fas fa-envelope mr-3 text-blue-500"></i>
                <span>My Invitations</span>
            </a>
            <a href="{% url 'create_group' %}" class="flex items-center p-2 text-gray-700 hover:bg-white rounded-lg transition duration-200">
                <i class="fas fa-users mr-3 text-purple-500"></i>
                <span>Create Group</span>
            </a>
            <a href="{% url 'profile' %}" class="flex items-center p-2 text-gray-700 hover:bg-white rounded-lg transition duration-200">
                <i class="fas fa-cog mr-3 text-gray-500"></i>
                <span>Settings</span>
            </a>
        </div>
    </div>
</div>
</body>
</html>